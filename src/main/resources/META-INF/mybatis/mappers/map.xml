<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sample.camping.dao.MapDao">

<select id="getCampSites" parameterType="string" resultType="campingsites">
	SELECT
		no,name,sort,latitude,longitude,address,tel,sites,price,likes,hates,photo,point,createDate,used,myCampingNo
			from(select row_number() over (order by campsite_no desc) row_no,
				campsite_no no,
				campsite_name name,
				campsite_sort sort,
				campsite_latitude latitude,
				campsite_longitude longitude,
				campsite_address address,
				campsite_tel tel,
				campsite_sites sites,
				campsite_price price,
				campsite_likes likes,
				campsite_hates hates,
				campsite_photo photo,
				campsite_point point,
				campsite_create_date createDate,
				campsite_used_yn used,
				my_campsite_no myCampingNo
			FROM
				 CAMP_CAMPSITES
			<where>
				<if test="city != '전국'">
					campsite_address like '%' || #{keyword} || '%'
				</if>
			</where>
			)
		WHERE
			row_no >= 1
		AND
			row_no &lt;= 10
		order BY
				no desc
</select>
<select id="getCampSitesList" parameterType="Map" resultType="campingsites">
	SELECT
		no,name,sort,latitude,longitude,address,tel,sites,price,likes,hates,photo,point,createDate,used,myCampingNo
			from(select row_number() over (order by campsite_no desc) row_no,
				campsite_no no,
				campsite_name name,
				campsite_sort sort,
				campsite_latitude latitude,
				campsite_longitude longitude,
				campsite_address address,
				campsite_tel tel,
				campsite_sites sites,
				campsite_price price,
				campsite_likes likes,
				campsite_hates hates,
				campsite_photo photo,
				campsite_point point,
				campsite_create_date createDate,
				campsite_used_yn used,
				my_campsite_no myCampingNo
			FROM
				 CAMP_CAMPSITES
			<where>
				<if test="citys != '전국'">
					campsite_address like '%' || #{citys} || '%'
				</if>
			</where>
			)
		WHERE
			row_no >= #{st}
		AND
			row_no &lt;= #{en}
		order BY
				no desc
</select>
<select id="getCampSitesCount" resultType="int">
	select
		count(*)
	from
		camp_campsites
</select>
</mapper>